# @package _global_

defaults:
  - /dataset: compress_libri

exp_name: compres_libri_SE_adLIF
unroll_factor: 64
encoder:
  dropout: 0.0
  l1:
    # input size 
    cell: se_adlif
    input_size: 1
    n_neurons: 200
    use_recurrent: False
    thr: 1.0
    # gain for feedforward weight initialization
    ff_gain: 10
    # Range of tau_u
    tau_u_range: [5, 25]
    # Range of tau_w
    tau_w_range: [60, 300]
    a_range: [0, 10]
    b_range: [0, 20]
    q: 12
    use_u_rest: True
    unroll: ${unroll_factor}
  l2:
    cell: se_adlif
    input_size: 200
    n_neurons: 200
    use_recurrent: True
    thr: 1.0
    # gain for feedforward weight initialization
    ff_gain: 10
    # Range of tau_u
    tau_u_range: [5, 25]
    # Range of tau_w
    tau_w_range: [60, 300]
    a_range: [0, 10]
    b_range: [0, 20]
    q: 12
    num_out_neuron: 16
    use_u_rest: True
    unroll: ${unroll_factor}
decoder:
  dropout: 0.0
  light_decoder: False
  l1:
    cell: se_adlif
    input_size: 16
    n_neurons: 200
    use_recurrent: True
    thr: 1.0
    # gain for feedforward weight initialization
    ff_gain: 10
    # Range of tau_u
    tau_u_range: [5, 25]
    # Range of tau_w
    tau_w_range: [60, 300]
    a_range: [0, 10]
    b_range: [0, 20]
    q: 12
    use_u_rest: True
    unroll: ${unroll_factor}
  l_out:
    input_size: 200
    n_neurons: 20
    reduce: 'mean' # perform reduce operation on the n_neurons dim (none, mean, sum)
    # Time constant of output layer 
    train_tau_u_method: 'interpolation'
    tau_u_range: [5, 60]
    unroll: ${unroll_factor}
# Parameters of SLAYER
alpha: 5.0
c: 0.8
thr: 1.0
dt: 1.0

# Number of epochs
n_epochs: 200


# Metric tracking
tracking_metric: val_loss
tracking_mode: min

# optimizer parameters
# learning rate of the optimizer
lr: 0.01
factor: 0.5
patience: 5

grad_norm: 5

# warm start, the lr is fixed at fast_epoch_lr_factor*lr for the first num_fast_epoch
num_fast_epoch: 0
fast_epoch_lr_factor: 10
skip_first_n: 50

# Spectral loss parameters (cf. https://arxiv.org/abs/2008.01160)
n_mels: 64 # number of bins in the mel-scale spectrogram (this is the features dimension of the spectrogram)
min_window: 6 # min size of the FFT windows in power of two 
max_window: 9 # max size of the FTT windows in power of two

# regularization parameters
min_spike_prob: [0.1, 0.005, 0.05] # , 0.1]
max_spike_prob: [0.2, 0.01, 0.1] #, 0.2]
min_layer_coeff: [10.0, 1.0, 10.0] #, 10.0] # encourage the first layer to spike
max_layer_coeff: [0, 1000, 100] # , 10.0] # here we may encourage lower spike for the second layer to encourage compression
compile: True

random_seed: 42